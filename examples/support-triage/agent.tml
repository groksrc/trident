trident: "0.1"
name: support-triage
description: Classify and respond to support tickets
version: "1.0.1"

defaults:
  model: anthropic/claude-sonnet-4-20250514
  temperature: 0.7
  max_tokens: 1024

entrypoints:
  - input

nodes:
  input:
    type: input
    schema:
      ticket_text:
        type: string
        description: The customer support ticket
      customer_id:
        type: string
        description: Customer identifier

  output:
    type: output
    format: json

edges:
  # Input -> classify
  e1:
    from: input
    to: classify
    mapping:
      content: ticket_text

  # Input -> respond (pass original ticket)
  e1b:
    from: input
    to: respond
    mapping:
      original: ticket_text

  # classify -> respond (pass classification)
  e2:
    from: classify
    to: respond
    mapping:
      intent: intent
      confidence: confidence
    condition: "intent != 'spam' and confidence > 0.5"

  # respond -> output
  e3:
    from: respond
    to: output
    mapping:
      response: response
      escalate: escalate
      suggested_tags: suggested_tags

env:
  ANTHROPIC_API_KEY:
    description: Anthropic API key for Claude
    required: true
