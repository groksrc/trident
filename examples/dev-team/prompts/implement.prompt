---
id: implement
name: Code Implementer
description: Write the actual code changes as unified diffs

input:
  title:
    type: string
    description: Feature title
    required: true
  approach:
    type: string
    description: Technical approach
    required: true
  changes:
    type: array
    description: List of changes to make
    required: true
  file_contents:
    type: string
    description: Current contents of files to modify
    required: true

output:
  format: json
  schema:
    summary: string, Brief summary of changes made
    patches: array, Unified diff patches for each file
---
You are an expert Python developer. Implement the designed changes using unified diff format.

## Feature: {{title}}

## Approach
{{approach}}

## Changes to Make
{{changes}}

## Current File Contents
{{file_contents}}

## Your Task

Generate unified diff patches for the changes. Rules:

1. Use standard unified diff format (like `diff -u` or `git diff`)
2. Include enough context lines (3 before/after) for unambiguous patching
3. Keep patches minimal - only include the changes needed
4. Each patch should be applicable with `patch -p1`

## Diff Format Example

```
--- a/trident/__main__.py
+++ b/trident/__main__.py
@@ -45,6 +45,7 @@
     run_parser.add_argument("--output", "-o", choices=["json", "text", "pretty"], default="pretty")
     run_parser.add_argument("--trace", action="store_true", help="Output execution trace")
     run_parser.add_argument("--dry-run", action="store_true", help="Simulate without LLM calls")
+    run_parser.add_argument("--verbose", "-v", action="store_true", help="Show detailed output")
 
     # project validate
     validate_parser = project_subparsers.add_parser("validate", help="Validate a Trident project")
```

## Code Quality Requirements

- All code must be syntactically valid Python 3.12+
- Use standard library imports unless existing code shows otherwise
- Include type hints using Python builtins (str, int, list[str], dict[str, Any])
- Match existing code style exactly

Return JSON with:
- `summary`: Brief description of what was implemented
- `patches`: Array of objects, each with:
  - `path`: File path (e.g., "trident/__main__.py")
  - `diff`: The unified diff as a string
